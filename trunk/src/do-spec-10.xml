<?xml version="1.0" encoding="UTF-8"?>
<?oxygen RNGSchema="../util/docbook/rng/docbookxi.rng" type="xml"?>
<book xmlns="http://docbook.org/ns/docbook" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xi="http://www.w3.org/2001/XInclude" xml:base=".">

    <!-- overarching layout 
        
       Introduction
         discuss scope and main usage scenarios, base and extended interface        
       Terminology  
         define reading system, service, core interface, extended interface, etc
       Protocol Fundamentals      
           WS-I
           Solely based on http://www.w3.org/TR/wsdl#_request-response and request only (when void return)
       Conformance Definitions
           define conformance of reading system, service etc   
       The Core Interface
         intro: what functionality you achieve by implementing this interface
         state definitions (valid session state?)
         formal API desc interspersed with atomic examples
         ending part with longer sequence scenarios
       The Extended Interface
         intro: what functionality you achieve by implementng this interface
         exceptions thrown if RS but not S supports the interface (the inverse can never happen)
         formal API desc interspersed with examples
         ending part with longer sequence scenarios
       Interface Reference (normative)  
         collated a la APIDoc, autogenerated from WSDL
       Type Reference (normative)  
         collated, autogenerated from XSD  
       Appendix: Daisy Online Protocol WSDL Definition (informative)         
       Appendix: Daisy Online Protocol WXS Type Definition  (informative)
       
    -->

    <title>DAISY Online Delivery Specification</title>
    <subtitle>A Web Service API for online access to DAISY and other multimedia content</subtitle>
    
    <info>
        <releaseinfo>Unpublished working draft</releaseinfo>
        <pubdate>7 july 2009</pubdate>
        <editor>
            <personname>Kenny Johar</personname>
            <affiliation>
                <orgname>Vision Australia</orgname>
            </affiliation>
            <email>kenny.johar@visionaustralia.org</email>
        </editor>
        <editor>
            <personname>Markus Gylling</personname>
            <affiliation>
                <orgname>DAISY Consortium</orgname>
            </affiliation>
            <email>mgylling@daisy.org</email>
        </editor>
        <!--
        <abstract>
            <title>Abstract</title>
            <para>
                <remark role="todo">Write abstract</remark>
            </para>
        </abstract>
        -->
    </info>

    <preface xml:id="introduction" conformance="informative">
        <title>Introduction</title>
        <para>
            <remark role="todo">Write introduction - target application domains, llending/distribution, functionality
                scope. Not limited to the daisy content type</remark>
        </para>
        <section>
            <title>Usage scenarios</title>
            <para>
                <remark role="todo">Describe use scenarios including autosubscribe to daily
                    newspaper, commercial service (advanced features), etc</remark>
            </para>
        </section>
    </preface>

    <chapter xml:id="keywords" conformance="normative">
        <title>Keywords</title>
        <para>The keywords "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD",
            "RECOMMENDED", "MAY", and "OPTIONAL" in this document are to be interpreted as described
            in <xref linkend="bib_RFC2119"></xref>.</para>
    </chapter>

    <chapter xml:id="terminology" conformance="normative">
        <title>Terminology</title>
        <variablelist>
            <varlistentry xml:id="term_readingSystem">
                <term>Reading System</term>
                <listitem>
                    <para>
                        A combination of hardware and/or software that accesses the service and renders content to
						the user.  A reading system may be implemented entirely on one device, or it may be split
						among several computers.  Corresponds to a consumer in the <xref linkend="bib_wsibasicprofile11_conf" />.
                    </para>
                </listitem>
            </varlistentry>
            <varlistentry xml:id="term_service">
                <term>Service</term>
                <listitem>
                    <para>
						Corresponds to an instance in the <xref linkend="bib_wsibasicprofile11_conf" />.
                        <remark role="todo">define</remark>
                    </para>
                </listitem>
            </varlistentry>
            <varlistentry xml:id="term_serviceDelegate">
                <term>Service Delegate</term>
                <listitem>
                    <para>
                        A file hosting server that is not under the control of the service provider.
                    </para>
                </listitem>
            </varlistentry>
            
            <varlistentry xml:id="term_user">
                <term>User</term>
                <listitem>
                    <para>
						A person who interacts with, or accesses content from, a service using a reading system.
                    </para>
                </listitem>
            </varlistentry>
			
            <varlistentry xml:id="term_serviceProdiver">
                <term>Service Provider</term>
                <listitem>
                    <para>
						The person(s) or organization(s) who own a service.
                    </para>
                </listitem>
            </varlistentry>
			
            <varlistentry xml:id="term_session">
                <term>Session</term>
                <listitem>
                    <para>
                        A session begins after a successful <link linkend="op_logOn">logOn</link> operation.  It
						ends after a successful <link linkend="op_logOn">logOff</link> operation, OR it may be timed
						out by the service.
                        <remark role="todo">define further</remark>
                    </para>
                </listitem>
            </varlistentry>
            <varlistentry xml:id="term_operation">
                <term>Operation</term>
                <listitem>
                    <para>
                        A <xref linkend="bib_wsdl1.1"></xref> operation.  An abstract description of an action
						supported by the service.
                    </para>
                </listitem>
            </varlistentry>
            <varlistentry xml:id="term_interface">
                <term>Interface</term>
                <listitem>
                    <para>
                        A <xref linkend="bib_wsdl1.1"></xref> port type.  An abstract set of operations supported by one
						or more endpoints. <remark role="todo">explain "endpoints"</remark>
                    </para>
                </listitem>
            </varlistentry>
            <!--
			<varlistentry xml:id="term_parameter">
                <term>Parameter</term>
                <listitem>
                    <para>
                        <remark>This is not defined in any of the referred specs.
						I don't think it would be of any help to define it here. -Geoff</remark>
                    </para>
                </listitem>
            </varlistentry>
			-->
            <varlistentry xml:id="term_fault">
                <term>Fault</term>
                <listitem>
                    <para>
						A <xref linkend="bib_soap1.1" /> Fault.  It is used to carry error and/or status information
						within a SOAP message.  <xref linkend="apiReferenceFaults" /> defines the faults used for
						this protocol.
                    </para>
                </listitem>
            </varlistentry>
            <varlistentry xml:id="term_content">
                <term>Content</term>
                <listitem>
                    <para>
                        Content data made available by the Service.
                        <remark role="todo">expand</remark>
                    </para>
                </listitem>
            </varlistentry>
            <varlistentry xml:id="term_contentDownload">
                <term>Content Download</term>
                <listitem>
                    <para>
                        Transfer of content from the service to the reading system, which the reading system stores
						indefinitely.
                    </para>
                </listitem>
            </varlistentry>
            <varlistentry xml:id="term_contentStreaming">
                <term>Content Streaming</term>
                <listitem>
                    <para>
                        Transfer of content from the service to the reading system, which the reading system renders
						immediately and stores only temporarily.</para>
                </listitem>
            </varlistentry>
        </variablelist>
		<note>
			<para>Content download and streaming are reading system behaviours, not aspects of the protocol
			proper.</para>
		</note>
    </chapter>

    <chapter xml:id="conformance" conformance="normative">
        <title>Conformance Definitions</title>
        <para>
            <remark role="todo">Define conformance criteria for Service and Reading System. This may
                also be placed towards the end of the spec, collecting all previously occurring
                conformance-defining statements. TBD towards the end of the editing work.</remark>
        </para>
    </chapter>

    <chapter xml:id="fundamentals">
        <title>Protocol Fundamentals</title>
        <section xml:id="fundamentals_protocols" conformance="normative">
            <title>Underlying protocols</title>
            <para> A compliant entity must support the following underlying protocols: <itemizedlist>
                    <listitem>
                        <para>
                            <xref linkend="bib_http11"></xref>
                        </para>
                    </listitem>
                    <listitem>
                        <para>
                            <xref linkend="bib_wsibasicprofile11"></xref>
                        </para>
                        <para>Note: <xref linkend="bib_httpcookies"></xref> states "R1121 An INSTANCE SHOULD NOT
                            require consumer support for Cookies in order to function correctly."
                            The Daisy Online protocol is a session based protocol, and http cookies
                            thus are fundamental to the protocol. </para>
                    </listitem>
                    <listitem>
                        <para>Secure http (https) through the use of <xref linkend="bib_ssl3.0"></xref> and <xref linkend="bib_tls1.0"></xref> </para>
                    </listitem>
                </itemizedlist>
            </para>
        </section>
        <section xml:id="fundamentals_dynamic_menus" conformance="informative">
            <title>Dynamic Menu Generation</title>
            <para>Many of the operations supported by this protocol (as described further in <xref linkend="operations"></xref>) make use of a <emphasis>dynamic menu
                    generation</emphasis> feature to allow users to interact and exchange
                information with the Service. The concept of dynamic menu generation is described
                below.</para>
            <para>
                <remark role="todo">Describe DMG in general terms, give an abstract example</remark>
            </para>
            <para>
                <remark role="todo">Need to define which of the DMG operations are endpoints.</remark>
            </para>
        </section>
    </chapter>

    <chapter xml:id="operations">
        <title>Protocol Operations</title>
        <para>
            <remark role="todo">Topic-based walkthrough of all aspects of the protocol. Makes hard
                references to API Reference and Type Reference, where functions and types are
                defined normatively. Always note whether part of required API or not.</remark>
            <!-- 
                Collated from old spec:
                Retrieve announcements that are awaiting a user's attention rom the service.
                Save and Retrieve the User's settings from the service.
                Register specific characteristics of the reading system with the service.
                Notify the Service of any errors that the Reading System encountered while in execution.
                Post diagnostic information to the Service.
                Perform other administrative tasks.
                
                Request the issuance of the specified content.
                Return the specified content.
                Perform a search on the available content.
                Retrieve the status of the specified content.
                Post the status of the specified content.
                Retrieve metadata for the specified content.
                Retrieve a list of available content.
                Retrieve metadata for a list of available content.
                
                Retrieve Bookmark information about a publication from the Service.
                Save Bookmark information about a Publication to the Service.
                
                Download Content.
                Review content while the download is in progress (aka progressive download).
                Stream Content.
                
                Retrieve an input type question from the Service.
                Retrieve an announcement (aka prompt) from the Service.
                Retrieve a choices type question from the Service.
                Retrieve metadata for a choices type question from the Service.
                Retrieve a grouped set of questions from the Service.
                Retrieve metadata for a grouped set of questions from the Service.
            -->
        </para>


        <section xml:id="operations_session">
            <title>Session Management and Authentication</title>
            <para>[Definition: session ready state]</para>
            <para>...</para>
        </section>

        <section xml:id="operations_content_issuing">
            <title>Issuing (and optional return) of content</title>
            <para>...</para>
            <section xml:id="operations_content_issuing_pdtb">
                <title>Rights management</title>
                <para>...</para>
            </section>
        </section>

        <section xml:id="operations_content_download">
            <title>Downloading and streaming of content</title>
            <para>...</para>
        </section>

        <section xml:id="operations_content_selection">
            <title>Content Selection</title>
            <para>
                <remark role="todo">contentlists, search</remark>
            </para>
        </section>

        <section xml:id="operations_service_announcements">
            <title>Service Announcements and/or Queries</title>
            <para>...</para>
        </section>

        <section xml:id="operations_bookmarks">
            <title>Bookmarks and Last Reading Position</title>
            <para>...</para>
        </section>

        <section xml:id="operations_diagnostics">
            <title>Diagnostics and Error Handling</title>
            <para>...</para>
        </section>

        <section xml:id="operations_complete_session_examples">
            <title>Complete session examples</title>
            <para>...</para>
        </section>

    </chapter>
<!--
    <chapter xml:id="stateReference" conformance="normative">
        <title>Session State Definitions</title>
        <variablelist>
            <varlistentry>
                <term>STATE_READY</term>
                <listitem>
                    <para>Active after: logon, followed by setReadingSystemAttributes.</para>
                    <para>Active until: end of session</para>
                    <para>Operations allowed when this state is active: x,y,z</para>
                </listitem>
            </varlistentry> -->
            <!--
             <varlistentry>
                 <term>STATE_ANNOUNCEMENTS_RETRIEVED</term>
                 <listitem>
                     <para>Parent state: READY</para>
                     <para>Active after: return getServiceAnnouncements.</para>
                     <para>Active until: end of session</para>
                     <para>Operations allowed when this state is active: all parent ops + markannouncementsasread</para>          
                 </listitem>
             </varlistentry>
             <varlistentry>
                 <term>STATE_USER_QUESTION_ASKED</term>
                 <listitem>
                     <para>Parent state: READY</para>
                     <para>Active after: </para>
                     <para>Active until: </para>
                     <para>Operations allowed when this state is active: all parent ops + getMessage, getGroupedQuestions, getQuestion, postUserResponses</para>          
                 </listitem>
             </varlistentry>
             --><!--
        </variablelist>
    </chapter>
-->
    <chapter xml:id="apiReference" conformance="normative">
        <title>API Definition</title>
        <para>Dont edit this chapter here in the docbook source - autogenerated from WSDL</para>
    </chapter>

    <chapter xml:id="typeReference" conformance="normative">
        <title>Type Definition</title>
        <para>Dont edit this chapter here in the docbook source - autogenerated from XSD</para>
    </chapter>

    <bibliography conformance="normative">
        <title>References</title>
        <biblioentry xml:id="bib_dublinCore">
            <abbrev>Dublin Core</abbrev>
            <title>
                <link xlink:href="http://dublincore.org/documents/2008/01/14/dces/">Dublin Core Metadata Element 
                    Set, Version 1.1</link>
            </title>
            <date>January 2008</date>   
         </biblioentry>
        <biblioentry xml:id="bib_RFC2119">
            <abbrev>RFC 2119</abbrev>
            <title>
                <link xlink:href="http://www.ietf.org/rfc/rfc2119.txt">Key words for use in RFCs to
                    Indicate Requirement Levels (RFC 2119)</link>
            </title>
            <date>March 1997</date>
        </biblioentry>
        <biblioentry xml:id="bib_mime">
            <abbrev>MIME</abbrev>
            <title>
                <link xlink:href="http://www.rfc-editor.org/rfc/rfc2046.txt">Multipurpose Internet 
                	Mail Extensions (MIME) Part Two: Media Types, RFC 2046</link>
            </title>
            <author>
                <personname>N.Freed, et al</personname>
            </author>
            <date>November 1996</date>
        </biblioentry>
        <biblioentry xml:id="bib_xsdDatatypes">
            <abbrev>XML Schema 2</abbrev>
            <title>
                <link xlink:href="http://www.w3.org/TR/xmlschema-2/">XML Schema Part 2: Datatypes
                    Second Edition</link>
            </title>
            <author>
                <personname>P. V. Biron, et al</personname>
            </author>
            <date>28 October 2004</date>
        </biblioentry>
        <!--
        <biblioentry xml:id="refXML">
            <abbrev>XML</abbrev>
            <title>
                <link xlink:href="http://www.w3.org/TR/2006/REC-xml-20060816/">Extensible Markup
                    Language (XML) 1.0 (Fourth Edition)</link>
            </title>
            <author>
                <personname>T. Bray, et al</personname>
            </author>
            <date>November 2008</date>
        </biblioentry>
        -->
        <biblioentry xml:id="bib_http11">
            <abbrev>HTTP 1.1</abbrev>
            <title>
                <link xlink:href="http://www.w3.org/Protocols/rfc2616/rfc2616.html">HyperText Transfer Protocol (HTTP) 1.1</link>
            </title>
        </biblioentry>

        <biblioentry xml:id="bib_httpcookies">
            <abbrev>HTTP Cookies</abbrev>
            <title>
                <link xlink:href="http://www.ws-i.org/Profiles/BasicProfile-1.1-2004-08-24.html#HTTP_Cookies">HTTP cookies in WS-I Basic Profile 1.1</link>
            </title>
        </biblioentry>

        <biblioentry xml:id="bib_soap1.1">
            <abbrev>SOAP 1.1</abbrev>
            <title>
                <link xlink:href="http://www.w3.org/TR/2000/NOTE-SOAP-20000508/">Simple Object Access Protocol (SOAP) 1.1</link>
            </title>
        </biblioentry>
        
        <biblioentry xml:id="bib_ssl3.0">
            <abbrev>SSL 3.0</abbrev>
            <title>
                <link xlink:href="http://tools.ietf.org/html/draft-ietf-tls-ssl-version3">Secure Sockets Layer (SSL) 3.0</link>
            </title>
        </biblioentry>
        
        <biblioentry xml:id="bib_tls1.0">
            <abbrev>TLS 1.0</abbrev>
            <title>
                <link xlink:href="http://www.ietf.org/rfc/rfc2246">Transport Layer Security (TLS) 1.0</link>
            </title>
        </biblioentry>
        
        <biblioentry xml:id="bib_wsibasicprofile11">
            <abbrev>WS-I Basic Profile 1.1</abbrev>
            <title>
                <link xlink:href="http://www.ws-i.org/Profiles/BasicProfile-1.1-2004-08-24.html">WS-I Basic Profile 1.1</link>
            </title>
        </biblioentry>
        
        <biblioentry xml:id="bib_wsibasicprofile11_conf">
            <abbrev>WS-I Basic Profile 1.1 Conformance Targets</abbrev>
            <title>
                <link xlink:href="http://www.ws-i.org/Profiles/BasicProfile-1.1.html#conformance_targets">WS-I Basic Profile 1.1 Conformance Targets</link>
            </title>
        </biblioentry>
        
        <biblioentry xml:id="bib_wsdl1.1">
            <abbrev>WSDL 1.1</abbrev>
            <title>
                <link xlink:href="http://www.w3.org/TR/2001/NOTE-wsdl-20010315">Web Services Definition Language (WSDL) 1.1</link>
            </title>
        </biblioentry>
        
    </bibliography>

    <acknowledgements>
        <title>Acknowledgements</title>
        <para>The following individuals were members of the DAISY Online Working Group at the time
            of the publication of this specification:</para>

        <itemizedlist>
            <listitem>
                <para>
                    <personname>
                        <firstname>Kenny</firstname>
                        <surname>Johar</surname>
                    </personname>
                    <jobtitle>Enterprise Architect</jobtitle>, <orgname>Vision Australia</orgname>
                    (co-chair) </para>
            </listitem>
        </itemizedlist>

        <para>The editors also wish to thank the following individuals for their contribution,
            either as former members of the Working Group, or as individual contributors:</para>

    </acknowledgements>

    <appendix xml:id="appendixWSDL" conformance="informative" xreflabel="WSDL">
        <title>DAISY Online Protocol - WSDL Definition</title>
        <programlisting><xi:include href="do-wsdl-10.wsdl" parse="text"></xi:include></programlisting>
    </appendix>

    <appendix xml:id="appendixXSD" conformance="normative" xreflabel="XSD">
        <title>DAISY Online Protocol - WXS Type Definition</title>
        <programlisting><xi:include href="do-types-10.xsd" parse="text"></xi:include></programlisting>
    </appendix>

</book>
