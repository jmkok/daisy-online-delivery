<?xml version="1.0" encoding="UTF-8"?>
<?oxygen RNGSchema="../util/docbook/rng/docbookxi.rng" type="xml"?>
<book xmlns="http://docbook.org/ns/docbook" xmlns:xlink="http://www.w3.org/1999/xlink"
    xmlns:xi="http://www.w3.org/2001/XInclude" xml:base=".">

    <!-- overarching layout 
        
       Introduction
         discuss scope and main usage scenarios, base and extended interface        
       Terminology  
         define reading system, service, core interface, extended interface, etc
       Protocol Fundamentals      
           WS-I
           Solely based on http://www.w3.org/TR/wsdl#_request-response and request only (when void return)
       Conformance Definitions
           define conformance of reading system, service etc   
       The Core Interface
         intro: what functionality you achieve by implementing this interface
         state definitions (valid session state?)
         formal API desc interspersed with atomic examples
         ending part with longer sequence scenarios
       The Extended Interface
         intro: what functionality you achieve by implementng this interface
         exceptions thrown if RS but not S supports the interface (the inverse can never happen)
         formal API desc interspersed with examples
         ending part with longer sequence scenarios
       Interface Reference (normative)  
         collated a la APIDoc, autogenerated from WSDL
       Type Reference (normative)  
         collated, autogenerated from XSD  
       Appendix: Daisy Online Protocol WSDL Definition (informative)         
       Appendix: Daisy Online Protocol WXS Type Definition  (informative)
       
    -->

    <title>DAISY Online Delivery Specification</title>
    <subtitle>A Web Protocol for Lending and Distribution of Multimedia Content</subtitle>
    <info>
        <releaseinfo>Unpublished working draft</releaseinfo>
        <pubdate>7 july 2009</pubdate>
        <editor>
            <personname>Kenny Johar</personname>
            <affiliation>
                <orgname>Vision Australia</orgname>
            </affiliation>
            <email>kenny.johar@visionaustralia.org</email>
        </editor>
        <editor>
            <personname>Markus Gylling</personname>
            <affiliation>
                <orgname>DAISY Consortium</orgname>
            </affiliation>
            <email>mgylling@daisy.org</email>
        </editor>
        <!--
        <abstract>
            <title>Abstract</title>
            <para>
                <remark role="todo">Write abstract</remark>
            </para>
        </abstract>
        -->
    </info>

    <preface xml:id="introduction" conformance="informative">
        <title>Introduction</title>
        <para>
            <remark role="todo">Write introduction - target application domains, functionality
                scope</remark>
        </para>
        <section>
            <title>Usage scenarios</title>
            <para>
                <remark role="todo">Describe use scenarios including autosubscribe to daily
                    newspaper, commercial service (advanced features), etc</remark>
            </para>
        </section>
    </preface>

    <chapter xml:id="keywords" conformance="normative">
        <title>Keywords</title>
        <para>The keywords "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD",
            "RECOMMENDED", "MAY", and "OPTIONAL" in this document are to be interpreted as described
            in <xref linkend="bib_RFC2119"/>.</para>
    </chapter>

    <chapter xml:id="terminology" conformance="informative">
        <title>Terminology</title>
        <variablelist>
            <varlistentry>
                <term>Reading System</term>
                <listitem>
                    <para>
                        <remark role="todo">define, relate to
                            http://www.ws-i.org/Profiles/BasicProfile-1.1.html#conformance_targets</remark>
                    </para>
                </listitem>
            </varlistentry>
            <varlistentry>
                <term>Service</term>
                <listitem>
                    <para>
                        <remark role="todo">define, relate to
                            http://www.ws-i.org/Profiles/BasicProfile-1.1.html#conformance_targets</remark>
                    </para>
                </listitem>
            </varlistentry>
            <varlistentry>
                <term>User</term>
                <listitem>
                    <para>
                        <remark role="todo">define</remark>
                    </para>
                </listitem>
            </varlistentry>
            <varlistentry>
                <term>Session</term>
                <listitem>
                    <para>
                        <remark role="todo">define</remark>
                    </para>
                </listitem>
            </varlistentry>
            <varlistentry>
                <term>API/Interface/Type/Element/Operation/Function and that entire cluster of
                    terms</term>
                <listitem>
                    <para>
                        <remark role="todo">define</remark>
                    </para>
                </listitem>
            </varlistentry>
            <varlistentry>
                <term>Content vs Publication</term>
                <listitem>
                    <para>
                        <remark role="todo">define</remark>
                    </para>
                </listitem>
            </varlistentry>
            <varlistentry>
                <term>Content Download</term>
                <listitem>
                    <para>
                        <remark role="todo">define</remark>
                    </para>
                </listitem>
            </varlistentry>
            <varlistentry>
                <term>Content Streaming</term>
                <listitem>
                    <para>
                        <remark role="todo">define</remark>
                    </para>
                </listitem>
            </varlistentry>
            <varlistentry>
                <term>Dynamic Menu Generation</term>
                <listitem>
                    <para>
                        <remark role="todo">define</remark>
                    </para>
                </listitem>
            </varlistentry>
        </variablelist>
    </chapter>

    <chapter xml:id="conformance" conformance="normative">
        <title>Conformance Definitions</title>
        <para>
            <remark role="todo">Define conformance criteria for Service and Reading System. This may
                also be placed towards the end of the spec, collecting all previously occurring
                conformance-defining statements. TBD towards the end of the editing work.</remark>
        </para>
    </chapter>

    <chapter xml:id="fundamentals">
        <title>Protocol Fundamentals</title>
        <section xml:id="fundamentals_protocols" conformance="normative">
            <title>Underlying protocols</title>
            <para> A compliant entity must support the following underlying protocols: <itemizedlist>
                    <listitem>
                        <para>
                            <xref linkend="bib_http11" />
                        </para>
                    </listitem>
                    <listitem>
                        <para>
                            <xref linkend="bib_wsibasicprofile11" />
                        </para>
                        <para>Note: <xref linkend="bib_httpcookies" /> states "R1121 An INSTANCE SHOULD NOT
                            require consumer support for Cookies in order to function correctly."
                            The Daisy Online protocol is a session based protocol, and http cookies
                            thus are fundamental to the protocol. </para>
                    </listitem>
                    <listitem>
                        <para>Secure http (https) through the use of SSL 3.0 and TLS 1.0</para>
                    </listitem>
                </itemizedlist>
            </para>
        </section>
        <section xml:id="fundamentals_dynamic_menus" conformance="informative">
            <title>Dynamic Menu Generation</title>
            <para>Many of the operations supported by this protocol (as described further in <xref
                    linkend="operations"/>) make use of a <emphasis>dynamic menu
                    generation</emphasis> feature to allow users to interact and exchange
                information with the Service. The concept of dynamic menu generation is described
                below.</para>
            <para>
                <remark role="todo">Describe DMG in general terms, give an abstract example</remark>
            </para>
        </section>
    </chapter>

    <chapter xml:id="operations">
        <title>Protocol Operations</title>
        <para>
            <remark role="todo">Topic-based walkthrough of all aspects of the protocol. Makes hard
                references to API Reference and Type Reference, where functions and types are
                defined normatively. Always note whether part of required API or not.</remark>
            <!-- 
                Collated from old spec:
                Retrieve announcements that are awaiting a user's attention rom the service.
                Save and Retrieve the User's settings from the service.
                Register specific characteristics of the reading system with the service.
                Notify the Service of any errors that the Reading System encountered while in execution.
                Post diagnostic information to the Service.
                Perform other administrative tasks.
                
                Request the issuance of the specified content.
                Return the specified content.
                Perform a search on the available content.
                Retrieve the status of the specified content.
                Post the status of the specified content.
                Retrieve metadata for the specified content.
                Retrieve a list of available content.
                Retrieve metadata for a list of available content.
                
                Retrieve Bookmark information about a publication from the Service.
                Save Bookmark information about a Publication to the Service.
                
                Download Content.
                Review content while the download is in progress (aka progressive download).
                Stream Content.
                
                Retrieve an input type question from the Service.
                Retrieve an announcement (aka prompt) from the Service.
                Retrieve a choices type question from the Service.
                Retrieve metadata for a choices type question from the Service.
                Retrieve a grouped set of questions from the Service.
                Retrieve metadata for a grouped set of questions from the Service.
            -->
        </para>


        <section xml:id="operations_session">
            <title>Session Management and Authentication</title>
            <para>[Definition: valid session state]</para>
            <para>...</para>
        </section>

        <section xml:id="operations_content_issuing">
            <title>Issuing (and optional return) of content</title>
            <para>...</para>
            <section xml:id="operations_content_issuing_pdtb">
                <title>Rights management</title>
                <para>...</para>
            </section>
        </section>

        <section xml:id="operations_content_download">
            <title>Downloading and streaming of content</title>
            <para>...</para>
        </section>

        <section xml:id="operations_content_selection">
            <title>Content Selection</title>
            <para>
                <remark role="todo">contentlists, search</remark>
            </para>
        </section>

        <section xml:id="operations_service_announcements">
            <title>Service Announcements and/or Queries</title>
            <para>...</para>
        </section>

        <section xml:id="operations_bookmarks">
            <title>Bookmarks and Last Reading Position</title>
            <para>...</para>
        </section>

        <section xml:id="operations_diagnostics">
            <title>Diagnostics and Error Handling</title>
            <para>...</para>
        </section>

        <section xml:id="operations_complete_session_examples">
            <title>Complete session examples</title>
            <para>...</para>
        </section>

    </chapter>

    <chapter xml:id="stateReference" conformance="normative">
        <title>Session State Definitions</title>
        <variablelist>
            <varlistentry>
                <term>STATE_READY</term>
                <listitem>
                    <para>Active after: logon, followed by setReadingSystemAttributes.</para>
                    <para>Active until: end of session</para>
                    <para>Operations allowed when this state is active: x,y,z</para>
                </listitem>
            </varlistentry>
            <!--
             <varlistentry>
                 <term>STATE_ANNOUNCEMENTS_RETRIEVED</term>
                 <listitem>
                     <para>Parent state: READY</para>
                     <para>Active after: return getServiceAnnouncements.</para>
                     <para>Active until: end of session</para>
                     <para>Operations allowed when this state is active: all parent ops + markannouncementsasread</para>          
                 </listitem>
             </varlistentry>
             <varlistentry>
                 <term>STATE_USER_QUESTION_ASKED</term>
                 <listitem>
                     <para>Parent state: READY</para>
                     <para>Active after: </para>
                     <para>Active until: </para>
                     <para>Operations allowed when this state is active: all parent ops + getMessage, getGroupedQuestions, getQuestion, postUserResponses</para>          
                 </listitem>
             </varlistentry>
             -->
        </variablelist>
    </chapter>

    <chapter xml:id="apiReference" conformance="normative">
        <title>API Definition</title>
        <para>Dont edit this chapter here in the docbook source - autogenerated from WSDL</para>
    </chapter>

    <chapter xml:id="typeReference" conformance="normative">
        <title>Type Definition</title>
        <para>Dont edit this chapter here in the docbook source - autogenerated from XSD</para>
    </chapter>

    <bibliography conformance="normative">
        <title>References</title>
        <biblioentry xml:id="bib_RFC2119">
            <abbrev>RFC2119</abbrev>
            <title>
                <link xlink:href="http://www.ietf.org/rfc/rfc2119.txt">Key words for use in RFCs to
                    Indicate Requirement Levels (RFC2119)</link>
            </title>
            <date>March 1997</date>
        </biblioentry>
        <biblioentry xml:id="bib_xsdDatatypes">
            <abbrev>XMLSCHEMA2</abbrev>
            <title>
                <link xlink:href="http://www.w3.org/TR/xmlschema-2/">XML Schema Part 2: Datatypes
                    Second Edition</link>
            </title>
            <author>
                <personname>P. V. Biron, et al</personname>
            </author>
            <date>28 October 2004</date>
        </biblioentry>
        <!--
        <biblioentry xml:id="refXML">
            <abbrev>XML</abbrev>
            <title>
                <link xlink:href="http://www.w3.org/TR/2006/REC-xml-20060816/">Extensible Markup
                    Language (XML) 1.0 (Fourth Edition)</link>
            </title>
            <author>
                <personname>T. Bray, et al</personname>
            </author>
            <date>November 2008</date>
        </biblioentry>
        -->
        <biblioentry xml:id="bib_http11">
            <abbrev>HTTP1.1</abbrev>
            <title>
                <link xlink:href="http://www.w3.org/Protocols/rfc2616/rfc2616.html">HTTP 1.1</link>
            </title>
        </biblioentry>

        <biblioentry xml:id="bib_httpcookies">
            <abbrev>HTTPCookies</abbrev>
            <title>
                <link xlink:href="http://www.ws-i.org/Profiles/BasicProfile-1.1-2004-08-24.html#HTTP_Cookies">HTTP cookies in Ws-I basic Profile 1.1</link>
            </title>
        </biblioentry>

        <biblioentry xml:id="bib_wsibasicprofile11">
            <abbrev>WS-IBasicprofile1.1</abbrev>
            <title>
                <link xlink:href="http://www.ws-i.org/Profiles/BasicProfile-1.1-2004-08-24.html">WS-I basic Profile 1.1</link>
            </title>
        </biblioentry>
        
    </bibliography>

    <acknowledgements>
        <title>Acknowledgements</title>
        <para>The following individuals were members of the DAISY Online Working Group at the time
            of the publication of this specification:</para>

        <itemizedlist>
            <listitem>
                <para>
                    <personname>
                        <firstname>Kenny</firstname>
                        <surname>Johar</surname>
                    </personname>
                    <jobtitle>Enterprise Architect</jobtitle>, <orgname>Vision Australia</orgname>
                    (co-chair) </para>
            </listitem>
        </itemizedlist>

        <para>The editors also wish to thank the following individuals for their contribution,
            either as former members of the Working Group, or as individual contributors:</para>

    </acknowledgements>

    <appendix xml:id="appendixWSDL" conformance="informative" xreflabel="WSDL">
        <title>DAISY Online Protocol - WSDL Definition</title>
        <programlisting><xi:include href="do-wsdl-10.wsdl" parse="text"/></programlisting>
    </appendix>

    <appendix xml:id="appendixXSD" conformance="informative" xreflabel="XSD">
        <title>DAISY Online Protocol - WXS Type Definition</title>
        <programlisting><xi:include href="do-types-10.xsd" parse="text"/></programlisting>
    </appendix>

</book>